---
layout: post
title: 'Patching the C65 ROM for the MEGA65'
date: 2021-12-04
author: 'Steven B. Combs, Ph.D.'
email: 'retrocombs@icloud.com'
comments: yes
permalink: patch-c65-rom
category: mega65
---

For those of us expecting our MEGA65 by Christmas, the news is bad. MEGA65 is delayed until March! If, like me, you were on the short list to receive a MEGA65 before the end of 2020, looks like it will be the Easter bunny making the delivery instead of Santa. Here's the official announcement from the Discord channel:

> HO HO OH NO! SANTA IS IN QUARANTINE! But we make sure the easter bunny gets his booster vaccination. Due to the current situation it is impossible for us to send out any MEGA65s in December. We are holding our breath for March. Please bear with us! tl;dr version: We have been fighting shortage of electronic components for months and mostly succeeded.  But now, last minute, seemingly trivial things like cardboard for your lovely printed boxes are unavailable! We most probably cannot ship before March 2022 and are truly sorry for this. The good news: We will then be able to ship larger quantities at once which means you might face close to or no delay at all. We will keep you updated and continue doing what we all, you - the community and the MEGA65 team, believe in. 

Am I disappointed? Yes; however, there are positives to this announcement (says the guy who always has a glass half full). Those who were on the second round of shipments will receive their MEGA65s at the same, or close to, as the original first 400 shipment. We will all enjoy them together! Lastly, while we wait, we have plenty to MEGA65 projects to dive into. I've shared earlier how to [setup a MEGA65 on a Nexys4](https://www.stevencombs.com/mega65-nexys) for less than $300 and [install the free Xemu emulator on a Mac](https://www.stevencombs.com/xemu-on-mac).

In these project I mention the closed ROM for the MEGA65 is available to purchasers of a [MEGA65](https://www.mega65.org) or [Dev Kit](https://www.stevencombs.com/mega65-1) and those who've not purchased a Dev Kit must "technically/legally" use the [open ROM](https://files.mega65.org?id=8aec2fba-3b0a-4677-80ae-7a7f5f4f0cb8); which is not yet ready for prime time. 

Since the open ROM needs time to bake (the last update was four months ago), using it means mixed results. We can search and download the original Commodore 65 ROM and then patch that file with tools created by the MEGA65 team until the MEGA65 arrives. In this post and companion blog post, I'll demonstrate the process and we will see if we can go back in time and load the original in development ROM in the emulator, Nexys4, and MEGA65 Dev Kit.

Before you read the rest of this post, take a look at my companion video below.

----

**Table of Contents** 

- [Companion YouTube Video](#companion-youtube-video)
- [Video Errata](#video-errata)
- [Links Mentioned in this Episode](#links-mentioned-in-this-episode)
- [Quick Commodore 65 History](#quick-commodore-65-history)
- [Obtain Original C65 ROM](#obtain-original-c65-rom)
- [Download Patch Tools](#download-patch-tools)
- [Download the C65 ROM Diff File](#download-the-c65-rom-diff-file)
- [Patch ROM](#patch-rom)
- [ROM file updates](#rom-file-updates)
- [Use Patched ROM](#use-patched-rom)
    - [MEGA65 and Nexys4 FPGA](#mega65-and-nexys4-fpga)
    - [Xemu](#xemu)
- [Final Thoughts](#final-thoughts)
- [Join the Fun](#join-the-fun)

<!-- Table of contents generator: https://ecotrust-canada.github.io/markdown-toc/ NOTE: Add two spaces for sub bullets -->

----

## Companion YouTube Video

Title: _Patch the Original Commodore 65 ROM \| Use with Nexys4 & Xemu_

In the video below, I demonstrate how to find, download, patch, and use the original C65 ROM with Xemu, a Nexys4, and on a MEGA65.

<div style="position:relative;padding-top:56.25%;"><p><iframe src="link" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" style="position:absolute;top:0;left:0;width:100%;height:100%;"></iframe></p></div>

## Video Errata

None as of 2021-12-04.

## Links Mentioned in this Episode

Below are the links I mention in this blog post and companion video. All Amazon links are affiliate links. A huge thank you for your support of the blog and the YouTube channel by starting your purchases here!

1. [Item](link)

## The Problem with the OpenROM

The OpenROM is an interesting project. A group of developers working to create a license free version of an operational ROM file that includes the updates from the MEGA65 close ROM and its own features. The details of this project are not in the scope of this project; however, this project is a work in progress and even simple program like the one below do not work:

```
10 PRINT "RETROCOMBS";
20 GOTO 10
```

This caused many complaints from readers and viewers who wanted to install Xemu or build a Neyxs4 MEGA65. I get it. The Nexys4 is a $300 project and not having a working ROM does not scream, value proposition. Xemu without a working ROM is a simple exercise in frustration. Let's fix that!

## Quick Commodore 65 History

The Commodore 65, formerly known as the C64 DX, never entered production and was to forever be a prototype in the year 1991. A successor the C64, Plus/4, and C128, the C65 was to be the 8-bit computer to rule them all. It was to include a super speedy 3.54 MHz CPU and graphics that rivaled the Commodore produced Amiga. Unfortunately the C65 never saw the light of day beyond the believed to be 200 prototype machines which leaded out in a clearance sale at the end of Commodore's life.

**History Reference:**
- [8-bit nirvana: Commodore 65](https://www.zock.com/8-Bit/D_C65.HTML)
- [Commodore 65 - Wikipedia](https://en.wikipedia.org/wiki/Commodore_65)
- 

## Obtain Original C65 ROM

 Owners fortunate enough to obtain an original C65 prototype have dumped the ROM file contents and shared them online. I'll not link directly to the ROMs I found; however, below are steps to get your search started.

> **NOTE:** As an owner of a MEGA65 Dev Kit, I own a license for the C65 ROM. More below.

1. Open a browser and navigate to your favorite search engine such as [Google](https://www.google.com) or [Duck Duck Go](https://www.duckduckgo.com) (preferred).
2. Search for `911001.BIN`.
3. If you find a page that has multiple C65 ROMs, download one with the specific name listed in step 2.
4. Make a copy of the file with the name `911001_archive.BIN` in case you need a copy of the original ROM file.
5. Place the `911001.BIN` file on your desktop or other easy to find location.

With an original ROM file on-hand, time to patch it and add the new features and functions of the MEGA65.

> **<font color="red">WARNING:</font>** Downloading and patching the C65 ROM files is a legal sticky-wicket. I share this process to educate the community; however, in order to use the original ROM, you must own a MEGA65, Dev Kit, or an original C65 (you have one in your closet, right?). [Cloanto](http://www.c64forever.com) owns the rights to C65 ROMs but does not include them in their *C64 Forever* license. Because of this odd legal issue for an abandoned 30-year old computer ROM, I take no responsibility for your legal/illegal use of original C65 ROMs.

## Use the Original ROM

I was curious to see if the original ROM would work in the emulator and on the two FPGA hardware options, the Neyxs4 and the MEGA65, and would software developed on today's modern MEGA65 work with the original ROM. Are the current developers honoring and respecting what came before in their upgraded version via compatibility? Let's find out. 

<!-- Check C64 Mode -->

### Xemu

Xemu uses the Xmega65 emulator. I've shared how to set up Xemu on a Mac and use the emulator [in an earlier post](https://www.stevencombs.com/xemu-on-mac); however, I will again share the process to use the original C65 ROM file before I test it:

1. Place the original ROM file on the desktop or another location easy to locate. There is no need to rename this ROM file when using it with Xemu.
2. Load the Xemu emulator, *xmega65*.
3. Right-click in the *xmega65* window and a menu will appear.
4. From the menu, *SD-card* \| *Update files on SD image*. The *select your ROM image file* window will appear as shown in the image below:

    ![xMEGA Menus](https://www.stevencombs.com/images/xemu-menu-update-sd-card.png)
    
5. Navigate to the ROM file location.
6. Select the ROM file and click *OK*. The prompt below will display:

    ``` System files on your SD-card image seems to be updated successfully. Next time you may need this function, you can use MEGA65.ROM which is a backup copy of your selected ROM. MEGA65 emulation is about to RESET now! ```

7. Click the *OK* button and *xmega65* will boot as shown in the image below:

    ![*xmega65* with MEGA65 licensed ROM](https://www.stevencombs.com/images/mega65/c65-rom.png)
    
Success! The original ROM does work with the software emulator. Let's test it using a demo disk I've prepared from modern software created by various MEGA65 developers. As you will see in the companion video, every single title I threw at the original ROM worked! I have to admit, this shocked me and put a huge smile in my face. There is a high-level of compatibility between the original ROM and the updates the MEGA65 team is making to complete and add features. Bravo!

### Nexys4

Now that we know it works with software emulation; what on the Nexys4 for Dev Kit FPGA? I'll start with the Nexys4 but the process to update the ROM is the same for both FPGA boards:

1. Remove the SD Card from the FPGA.
2. Place the SD Card into a computer.
3. Rename the original ROM file `MEGA65.ROM`.
4. Copy the ROM file to the SD Card.
5. Eject the SD Card.
6. Insert the SD Card into the FPGA.
7. Turn on the FPGA.


### Dev Kit

Finally, I'll test the original ROM on my MEGA65 Dev Kit. I suspected the same result as the Nexys4 and was not disappointed.

## Patch the Original C65 ROM

Using the original ROM is huge improvement over the OpenROM; however, if you want the latest features of the MEGA65, the development team provides and option to patch the original ROM to include all the latest features of the the ClosedROM. Here's the process:

### Download Patch Tools

There are a couple of ways to patch the original ROM; however, I'll share the easiest GUI method using M65 Connect. Since M65Connect is available for Mac, Linux, and Windows, everyone will be able to patch the C65 ROM. Let's download a copy of M65Connect.

1. Use a web browser and visit the MEGA65 FileHost at <https://files.mega65.org>.
2. Click the *Files* button in the upper-left corner of the page.
3. In the *File search…* box, type `M65Co` and a list of M65Connect versions will display.
4. Click the download button \|<u>↓</u>\| in the row that matches the operating systems you use.
5. Install the application.

We are now ready to patch the original C65 ROM.

### Download the C65 ROM Diff File

1. Return to the *Files* area of the *FileHost* in your browser.
2. In the *File search…* box, type `‌diff files` and the ROM patch file named `C65 ROM diff files` will appear.
3. Click the download button \|<u>↓</u>\| and save the diff file in the same location as the original C65 ROM file.

Let's patch the original ROM with the diff file.

> **NOTE:** If you click the diff file title on the FileHost additional information about the page k

### Patch the ROM

M65Connect makes patching the original C65 ROM a point and click process.

1. Load the M65Connect application.
2. From the main menu, select *File* \| *Patch ROM File* and the Patch ROM file dialog box will appear as shown below:

    ![Patch ROM File dialog box](https://www.stevencombs.com/images/mega65/patch-rom-dialog.png)
    
3. Select the *Source ROM File* by clicking the folder button 📁 to the right of the text box to display a file selection dialog box.
4. Navigate to the location of the original C65 ROM file named `911001.BIN` and select.
5. Select the *ROM Patch File* by clicking the folder button 📁 to the right of the text box to display a file selection dialog box.
6. Navigate to the location of the diff file with a name similar to `920262.BDF` and select.
7. Verify the names in the text boxes are correct.
8. Click the *Save patched ROM as…* button and the *Save patched ROM file as…* dialog box will appear.
9. Save the file as `MEGA65.BIN` and press the *Save* button and the new file will be saved to the same location as the two original files.

The resultant `MEGA65.BIN` file is now ready to use.

### Patch updates

Update the patched ROM when the MEGA65 team releases new diff files. There are three ways to do this:

1. Use the same steps found in the previous section to update the original ROM.
2. Use the same steps found in the previous section to update the recent patched ROM. 
3. **Coming Soon!** Copy the diff file to an SD Card and use the *Freezer* on a MEGA65 to patch the ROM file.

## Use Patched ROM

Using the process outlines earlier to update the ROMs for both the software emulation and FPGA, it is time to see if the patch ROM works.

### Xemu

1. Rename `MEGA65.BIN` to `MEGA65.ROM`.
2. Load the *xmega65* Xemu application.
3. Right-click anywhere on the *xmega65* window and menu items will appear 
    
4. Select *SD-card* \| *Update file on SD image* and a browse file dialog box will appear.
5. Select the patched ROM file. 
6. Click *Open* and the ROM update verification dialog box shown below will display.

    ![Update ROM dialog box](https://raw.githubusercontent.com/stevencombs/stevencombs.github.io/2708d2c4ddae7e65aef332708732c3be78bf0ca7/images/mega65/xemu-rom-update-verification.png)
    
7. Click the *OK* button and *xmega65* will update the virtual SD card, reboot with the patched ROM, and display the ROM version on the main screen.

You can now experiment and use the latest ROM image on virtual and physical hardware. When you compare performance of the ROM patch with the open ROM, I think you will agree, at present this is the better option. That is, until you purchase a MEGA65 which entitles you to download the closed ROM and thereby eliminates the need to continually patch ROMs.

### MEGA65 and Nexys4 FPGA

1. Rename `MEGA65.BIN` to `MEGA65.ROM`.
2. Copy the ROM file to the SD Card. Overwrite the existing ROM file or rename that file to retain a working copy if things go wrong.
3. Place the SD card into the MEGA65 or Nexys4.
4. Boot the device and the diff file name similar to (920262) will appear as the current ROM on the MEGA65 start screen as shown in the image below:

    ![Verify the ROM on the MEGA65 Start Screen](https://www.stevencombs.com/images/mega65/verify-rom.png)

## Final Thoughts

1. I should have shared this with or immediately after my posts on the [Xemu emulator](https://www.stevencombs.com/xemu-on-mac) or [Nexys4 FPGA](https://www.stevencombs.com/mega65-nexys4-livestream). I had a couple of folks share their frustration with the open ROM on these platforms.
2. Let's chat about the legal aspect of this process.

## Join the Fun

Don't miss the retro-computing fun. <font color="red">SUBSCRIBE</font> to my [YouTube channel](https://www.youtube.com/stevencombs) and check out [my other posts](https://www.stevencombs.com).

Help make this content better! Leave your comments, corrections, additions, and thoughts in the comments below. You can email me at [retrocombs@icloud.com](mailto:retrocombs@icloud.com). Thanks for reading and if you are inclined, please let others know about the blog using the hashtag #retroCombs.

🕹️ retroCombs, OUT!
